#!/bin/bash

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
#  –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ï –ö–û–ü–ò–†–û–í–ê–ù–ò–ï –ù–ê DESKTOP
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

echo "üîç –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞..."

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
CURRENT_DIR=$(pwd)
echo "üìÅ –¢–µ–∫—É—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: $CURRENT_DIR"

# –¶–µ–ª–µ–≤–∞—è –ø–∞–ø–∫–∞
TARGET="$HOME/Desktop/—Å—Ç–∏–ª—å–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –∞—Ä—Ç–∏—Å—Ç–∞ 2"

# –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
if [ ! -d "$TARGET" ]; then
    echo "üìÅ –°–æ–∑–¥–∞—é –ø–∞–ø–∫—É: $TARGET"
    mkdir -p "$TARGET"
fi

echo ""
echo "üìã –ö–æ–ø–∏—Ä—É—é —Ñ–∞–π–ª—ã..."
echo "    –ò–∑: $CURRENT_DIR"
echo "    –í:  $TARGET"
echo ""

# –ö–æ–ø–∏—Ä—É–µ–º –≤—Å–µ –∫—Ä–æ–º–µ node_modules –∏ .git
rsync -av \
    --exclude='node_modules' \
    --exclude='.git' \
    --exclude='*.log' \
    "$CURRENT_DIR/" "$TARGET/" 2>&1 | grep -v "sending incremental file list"

if [ $? -eq 0 ]; then
    echo ""
    echo "‚úÖ –ì–û–¢–û–í–û! –§–∞–π–ª—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã!"
    echo ""
    echo "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:"
    echo "   –§–∞–π–ª–æ–≤: $(find "$TARGET" -type f | wc -l)"
    echo "   –ü–∞–ø–æ–∫:  $(find "$TARGET" -type d | wc -l)"
    echo ""
    echo "üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:"
    echo ""
    echo "   cd \"$TARGET\""
    echo "   git add ."
    echo "   git commit -m 'feat: CI/CD –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ'"
    echo "   git push"
    echo ""
else
    echo ""
    echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏"
    echo ""
    echo "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é:"
    echo "   cp -r . \"$TARGET\"/
    echo ""
fi
