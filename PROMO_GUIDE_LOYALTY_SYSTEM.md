# 🎁 PROMO.GUIDE LOYALTY SYSTEM - QR-КОДЫ И ГЕЙМИФИКАЦИЯ

## 🤯 ПРОБЛЕМА, КОТОРУЮ МЫ ТОЛЬКО ЧТО РЕШИЛИ

### До этого:
```
Venue спрашивает: "Как я узнаю что клиент пришел через вас?"
Мы отвечаем: "Эм... аналитика просмотров? 🤷"

❌ НЕТ ПРЯМОГО ДОКАЗАТЕЛЬСТВА!
```

### Теперь:
```
Посетитель → Открыл Promo.Guide → Пришел в venue
↓
Показал QR-код → Получил 15% скидку
↓
Venue видит: "Клиент #47 пришел через Promo.Guide"
↓
✅ ПРЯМОЕ ДОКАЗАТЕЛЬСТВО ROI!
```

---

## 🎯 КОНЦЕПЦИЯ: QR-КОД СО СКИДКОЙ

### Как это работает:

```
╔═══════════════════════════════════════════════════════╗
║  ШАГ 1: Пользователь открывает venue в Promo.Guide   ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  🏢 Sunset Lounge Bar                                 ║
║  🎵 Miles Davis - So What                             ║
║  📍 0.5 км от тебя                                    ║
║                                                       ║
║  ┌─────────────────────────────────────────────────┐ ║
║  │  💎 СПЕЦИАЛЬНОЕ ПРЕДЛОЖЕНИЕ                     │ ║
║  │                                                  │ ║
║  │  Покажи этот QR-код при заказе                  │ ║
║  │  и получи 15% скидку!                           │ ║
║  │                                                  │ ║
║  │        ┌───────────────┐                        │ ║
║  │        │   QR  CODE    │                        │ ║
║  │        │   ████████    │                        │ ║
║  │        │   ██    ██    │                        │ ║
║  │        │   ████████    │                        │ ║
║  │        └───────────────┘                        │ ║
║  │                                                  │ ║
║  │  Код: PROMO-SL-A47B9                            │ ║
║  │  Действует: сегодня до 23:59                    │ ║
║  │                                                  │ ║
║  └─────────────────────────────────────────────────┘ ║
║                                                       ║
║  [Построить маршрут]  [Активировать код]             ║
║                                                       ║
╚═══════════════════════════════════════════════════════╝
```

---

```
╔═══════════════════════════════════════════════════════╗
║  ШАГ 2: Посетитель приходит в venue                   ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  Посетитель → Официанту:                              ║
║  "У меня есть промокод от Promo.Guide!"              ║
║                                                       ║
║  Официант → Сканирует QR-код планшетом venue         ║
║                                                       ║
║  Система → Проверяет:                                 ║
║  ✅ Код валидный                                      ║
║  ✅ Не использован ранее                              ║
║  ✅ Действует сегодня                                 ║
║  ✅ Применяется скидка 15%                            ║
║                                                       ║
╚═══════════════════════════════════════════════════════╝
```

---

```
╔═══════════════════════════════════════════════════════╗
║  ШАГ 3: Venue видит результат в реальном времени      ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  📊 DASHBOARD VENUE                                   ║
║                                                       ║
║  СЕГОДНЯ через Promo.Guide:                           ║
║  ├─ 12 клиентов пришли                                ║
║  ├─ Средний чек: $50                                  ║
║  ├─ Скидка: 15% = $7.50                               ║
║  ├─ Доход: $600                                       ║
║  ├─ Расходы на скидку: $90                            ║
║  └─ Прибыль: $510 (ROI = 567%)                        ║
║                                                       ║
║  ЭТОТ МЕСЯЦ:                                          ║
║  ├─ 127 клиентов                                      ║
║  ├─ Доход: $6,350                                     ║
║  ├─ Стоимость Premium: $299                           ║
║  └─ ROI: 2,123% 🚀                                    ║
║                                                       ║
╚═══════════════════════════════════════════════════════╝
```

---

## 💎 РАСШИРЕННАЯ КОНЦЕПЦИЯ

### 1. **Динамическая скидка** (на основе трека!)

```
Обычная скидка: 10%

НО! Если сейчас играет артист, которого ты лайкнул:
→ 15% скидка!

НО! Если ты впервые в этом venue через Promo.Guide:
→ 20% скидка на первый визит!

НО! Если привел друга:
→ 25% скидка обоим!
```

**Это МОЩНО потому что:**
- Мотивирует приходить когда играет любимый артист
- Мотивирует пробовать новые venue
- Мотивирует приводить друзей

---

### 2. **Геймификация: Music Explorer Program**

```
╔═══════════════════════════════════════════════════════╗
║  🏆 ВАШ УРОВЕНЬ: Music Explorer                       ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  Прогресс до следующего уровня:                       ║
║  ████████░░░░░░░░ 8/10 venue посещено                 ║
║                                                       ║
║  🎵 БЕЙДЖИ:                                           ║
║  ✅ Jazz Lover        - Посетил 3 джаз-бара           ║
║  ✅ Night Owl         - Был в клубе после 01:00       ║
║  ✅ Early Bird        - Пришел в кафе до 10:00        ║
║  ✅ Vinyl Hunter      - Слушал 10 классических треков ║
║  ⬜ Techno Head       - Посети 5 техно-клубов         ║
║  ⬜ Music Guru        - Посети venue во всех жанрах   ║
║                                                       ║
║  🎁 НАГРАДЫ:                                          ║
║  Level 1 (Beginner):    10% скидка                    ║
║  Level 2 (Explorer):    15% скидка                    ║
║  Level 3 (Connoisseur): 20% скидка + приоритет       ║
║  Level 4 (Legend):      25% скидка + VIP доступ      ║
║                                                       ║
╚═══════════════════════════════════════════════════════╝
```

---

### 3. **Check-in с треком** (музыкальная история)

```
╔═══════════════════════════════════════════════════════╗
║  📍 ВЫ СЕЙЧАС В: Sunset Lounge Bar                    ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  🎵 Сейчас играет:                                    ║
║  Miles Davis - So What                                ║
║                                                       ║
║  ┌─────────────────────────────────────────────────┐ ║
║  │  Сделать чекин с этим треком?                   │ ║
║  │                                                  │ ║
║  │  ✅ Сохранить в музыкальную историю             │ ║
║  │  ✅ Поделиться в Stories                        │ ║
║  │  ✅ Получить +50 баллов                         │ ║
║  │                                                  │ ║
║  │  [📸 Чекин с треком]                            │ ║
║  └─────────────────────────────────────────────────┘ ║
║                                                       ║
╚═══════════════════════════════════════════════════════╝
```

**После чекина:**
```
Instagram Story:
┌─────────────────────────────────┐
│  📍 Sunset Lounge Bar           │
│                                 │
│  [Фото заведения]               │
│                                 │
│  🎵 Miles Davis - So What       │
│                                 │
│  "Кайфую под классический джаз │
│   в Sunset Lounge! 🎷"          │
│                                 │
│  #promoguide #sunsetlounge      │
│  #milesdavis                    │
│                                 │
│  Открыть в Promo.Guide 👆       │
└─────────────────────────────────┘
```

---

### 4. **"Артист дня" - двойная скидка**

```
╔═══════════════════════════════════════════════════════╗
║  🔥 СПЕЦИАЛЬНОЕ ПРЕДЛОЖЕНИЕ СЕГОДНЯ                   ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  🎤 "Артист дня": DJ Artem                            ║
║                                                       ║
║  Приходи в NEON Club с 22:00 до 00:00                 ║
║  когда играют треки DJ Artem                          ║
║  и получи 30% скидку!                                 ║
║                                                       ║
║  Обычная скидка: 15%                                  ║
║  Бонус "Артист дня": +15%                             ║
║  = 30% ИТОГО! 🎉                                      ║
║                                                       ║
║  [Активировать предложение]                           ║
║                                                       ║
╚═══════════════════════════════════════════════════════╝
```

**Артист получает:**
- % от продаж в этот день (например 2%)
- Статистику: "Привел 15 клиентов, venue заработало $750"
- Мотивацию продвигать свой "день" в соцсетях

---

### 5. **Promo Credits** (внутренняя валюта)

```
╔═══════════════════════════════════════════════════════╗
║  💰 ВАШ БАЛАНС: 1,250 Promo Credits                   ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  КАК ЗАРАБОТАТЬ:                                      ║
║  ✅ Посетил venue через Promo.Guide: +100 credits     ║
║  ✅ Сделал чекин с треком: +50 credits                ║
║  ✅ Поделился в Stories: +30 credits                  ║
║  ✅ Привел друга: +200 credits                        ║
║  ✅ Написал отзыв: +75 credits                        ║
║                                                       ║
║  НА ЧТО ПОТРАТИТЬ:                                    ║
║  🎵 500 credits = 1 месяц Promo.Music Pro             ║
║  🎫 1000 credits = Билет на концерт (скидка 50%)      ║
║  👕 800 credits = Мерч любимого артиста               ║
║  💎 2000 credits = VIP статус на месяц                ║
║  🎁 300 credits = Бесплатный дринк в venue            ║
║                                                       ║
╚═══════════════════════════════════════════════════════╝
```

---

### 6. **Реферальная программа**

```
╔═══════════════════════════════════════════════════════╗
║  👥 ПРИГЛАСИ ДРУГА                                    ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  Твоя реферальная ссылка:                             ║
║  promo.guide/r/alexey123                              ║
║                                                       ║
║  Друг регистрируется по ссылке:                       ║
║  ✅ Он получает 20% скидку на первый визит            ║
║  ✅ Ты получаешь 500 Promo Credits                    ║
║                                                       ║
║  Он посещает 3 venue:                                 ║
║  ✅ Он получает постоянную 15% скидку                 ║
║  ✅ Ты получаешь еще 1000 Promo Credits               ║
║                                                       ║
║  📊 ТВОЯ СТАТИСТИКА:                                  ║
║  Приглашено друзей: 7                                 ║
║  Активных: 5                                          ║
║  Заработано credits: 4,500                            ║
║                                                       ║
║  [Поделиться ссылкой]                                 ║
║                                                       ║
╚═══════════════════════════════════════════════════════╝
```

---

### 7. **Музыкальные события в календаре**

```
╔═══════════════════════════════════════════════════════╗
║  📅 СОБЫТИЯ ЭТОЙ НЕДЕЛИ                               ║
╠═══════════════════════════════════════════════════════╣
║                                                       ║
║  СЕГОДНЯ, 20:00                                       ║
║  🎷 Jazz Night в Sunset Lounge                        ║
║  Специальный гость: Московский джаз-квартет           ║
║  Промокод: 20% скидка для Promo.Guide                 ║
║  [Зарегистрироваться]                                 ║
║                                                       ║
║  ПЯТНИЦА, 23:00                                       ║
║  🎧 Techno Marathon в NEON Club                       ║
║  DJ: Amelie Lens + 3 резидента                        ║
║  Early bird (до 00:00): Вход $10 вместо $25           ║
║  [Купить билет]                                       ║
║                                                       ║
║  ВОСКРЕСЕНЬЕ, 12:00                                   ║
║  ☕ Vinyl Brunch в Coffee & Vinyl                      ║
║  Слушаем редкие пластинки + бранч                     ║
║  Для Promo.Guide: Бесплатный кофе                     ║
║  [Забронировать столик]                               ║
║                                                       ║
╚═══════════════════════════════════════════════════════╝
```

---

## 🔧 ТЕХНИЧЕСКАЯ РЕАЛИЗАЦИЯ

### QR-код система:

```typescript
// Генерация QR-кода для пользователя
POST /api/promo-guide/generate-qr
Body: {
  userId: "user-123",
  venueId: "venue-456",
  discountPercent: 15
}
Response: {
  qrCode: "PROMO-SL-A47B9",
  qrImage: "data:image/png;base64,...",
  expiresAt: "2026-02-04T23:59:59Z",
  discount: 15,
  firstVisitBonus: false // true если первый визит
}

// Venue сканирует QR-код
POST /api/venue/scan-qr
Body: {
  venueId: "venue-456",
  qrCode: "PROMO-SL-A47B9"
}
Response: {
  valid: true,
  userId: "user-123",
  userName: "Алексей",
  discount: 15,
  userLevel: "Explorer",
  firstVisit: false,
  specialOffer: null
}

// Применение скидки
POST /api/venue/apply-discount
Body: {
  venueId: "venue-456",
  qrCode: "PROMO-SL-A47B9",
  billAmount: 1000,
  discountApplied: 150
}
Response: {
  success: true,
  finalAmount: 850,
  creditsEarned: 100, // Для пользователя
  trackingId: "visit-789"
}
```

---

### SQL структура:

```sql
-- QR коды
CREATE TABLE promo_codes (
  id UUID PRIMARY KEY,
  code TEXT UNIQUE NOT NULL, -- "PROMO-SL-A47B9"
  user_id UUID REFERENCES users(id),
  venue_id UUID REFERENCES venue_profiles(id),
  discount_percent INTEGER DEFAULT 15,
  expires_at TIMESTAMPTZ,
  used BOOLEAN DEFAULT false,
  used_at TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Визиты через Promo.Guide
CREATE TABLE promo_guide_visits (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id),
  venue_id UUID REFERENCES venue_profiles(id),
  promo_code_id UUID REFERENCES promo_codes(id),
  
  -- Финансы
  bill_amount DECIMAL,
  discount_amount DECIMAL,
  final_amount DECIMAL,
  
  -- Что играло
  track_played_id UUID,
  track_played_name TEXT,
  artist_played TEXT,
  
  -- Атрибуция
  came_from TEXT DEFAULT 'promo_guide', -- 'promo_guide', 'referral', 'event'
  referral_user_id UUID, -- Если пришел по рефералке
  
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Promo Credits
CREATE TABLE promo_credits_balance (
  user_id UUID PRIMARY KEY REFERENCES users(id),
  balance INTEGER DEFAULT 0,
  lifetime_earned INTEGER DEFAULT 0,
  lifetime_spent INTEGER DEFAULT 0,
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE TABLE promo_credits_transactions (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id),
  type TEXT, -- 'earn_visit', 'earn_checkin', 'earn_referral', 'spend_subscription', etc
  amount INTEGER, -- положительное = заработал, отрицательное = потратил
  description TEXT,
  metadata JSONB, -- venue_id, track_id, etc
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Геймификация: Бейджи
CREATE TABLE user_badges (
  user_id UUID REFERENCES users(id),
  badge_type TEXT, -- 'jazz_lover', 'night_owl', 'early_bird', etc
  earned_at TIMESTAMPTZ DEFAULT NOW(),
  PRIMARY KEY (user_id, badge_type)
);

-- Чекины
CREATE TABLE venue_checkins (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES users(id),
  venue_id UUID REFERENCES venue_profiles(id),
  track_id UUID,
  track_name TEXT,
  artist_name TEXT,
  shared_to_social BOOLEAN DEFAULT false,
  photo_url TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Уровни пользователей
CREATE TABLE user_levels (
  user_id UUID PRIMARY KEY REFERENCES users(id),
  level INTEGER DEFAULT 1, -- 1=Beginner, 2=Explorer, 3=Connoisseur, 4=Legend
  total_visits INTEGER DEFAULT 0,
  unique_venues INTEGER DEFAULT 0,
  unique_genres INTEGER DEFAULT 0,
  total_checkins INTEGER DEFAULT 0,
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

---

## 📊 ЭКОНОМИКА СИСТЕМЫ

### Для Venue:

```
СЦЕНАРИЙ: 100 клиентов/месяц через Promo.Guide

Без скидки:
- 100 клиентов × $50 = $5,000
- Расходы на привлечение: $0 (органика? Google Ads? ХЗ)
- Прибыль: $5,000

Со скидкой 15%:
- 100 клиентов × $50 = $5,000
- Скидка 15% = -$750
- Подписка Premium: -$299
- Прибыль: $3,951

НО! Эти 100 клиентов не пришли бы БЕЗ Promo.Guide!
Реальная прибыль: $3,951 vs $0
ROI: ∞ % 🚀
```

---

### Для пользователя:

```
Посещает 4 venue/месяц через Promo.Guide

Без скидки:
- 4 × $50 = $200

Со скидкой 15%:
- 4 × $50 × 0.85 = $170
- Экономия: $30/месяц = $360/год

ПЛЮС:
- Заработал 400 Promo Credits
- = 1 месяц бесплатного Promo.Music Pro ($29)
- Итого экономия: $389/год!
```

---

### Для артиста ("Артист дня"):

```
Venue: NEON Club
"Артист дня": DJ Artem
Скидка для клиентов: 30% (15% базовая + 15% бонус)
Доля артиста: 2% от продаж в этот день

Результат:
- 20 клиентов пришли в "Артист дня"
- Средний чек: $50
- Продажи: $1,000
- Доля DJ Artem: $20

Но самое главное:
- DJ Artem продвигал день в соцсетях
- Его 10,000 подписчиков узнали о NEON Club
- 5 из 20 клиентов стали постоянными
- NEON Club получил $250 дополнительного дохода/месяц

Win-Win! 🎉
```

---

## 🚀 ВНЕДРЕНИЕ

### Фаза 1: MVP QR-системы (1 месяц)

```
✅ Генерация QR-кодов для пользователей
✅ Сканирование в venue (веб-интерфейс)
✅ Применение скидки 15%
✅ Базовая аналитика для venue
✅ 10 тестовых venue
```

### Фаза 2: Геймификация (2 месяца)

```
✅ Система уровней (4 уровня)
✅ Бейджи (10 штук)
✅ Promo Credits
✅ Чекины с треками
✅ История музыкальных открытий
```

### Фаза 3: Расширенные фичи (3 месяца)

```
✅ "Артист дня" с двойной скидкой
✅ Реферальная программа
✅ Календарь событий
✅ Интеграция с Instagram Stories
✅ Магазин Promo Credits
```

---

## 💎 ПОЧЕМУ ЭТО УБИВАЕТ

### 1. **Прямое доказательство ROI**
```
Venue видит в реальном времени:
"47 клиентов пришли через Promo.Guide"
"Доход: $2,350"
"ROI: 786%"

НЕОСПОРИМО! 💥
```

### 2. **Мотивация пользователей**
```
Без скидки: "Ну окей, классный гайд"
Со скидкой: "НУЖНО идти! Экономлю $7.50!"

ДЕЙСТВИЕ вместо интереса! 💪
```

### 3. **Геймификация = привыкание**
```
"Осталось посетить 2 venue до уровня Legend!"
"Нужно еще 300 credits до бесплатной подписки!"

ЗАВИСИМОСТЬ! 🎮
```

### 4. **Вирусный эффект**
```
Чекин с треком → Instagram Story → Друзья видят
→ "О, и я хочу такую скидку!"
→ Регистрируются через реферальную ссылку
→ Оба получают бонус
→ 🔄 LOOP!
```

### 5. **Артисты становятся промоутерами**
```
"Артист дня" → Артист постит у себя
→ Его фаны идут в venue
→ Артист получает % от продаж
→ Артист еще активнее продвигает
→ 🔄 LOOP!
```

---

## 🎯 ИТОГОВАЯ ФОРМУЛА УСПЕХА

```
Promo.Guide (открытие через музыку)
        +
QR-коды со скидкой (мотивация прийти)
        +
Атрибуция (доказательство ROI)
        +
Геймификация (привыкание)
        +
Promo Credits (внутренняя экономика)
        +
Реферальная программа (вирусность)
        =
💎 НЕПОБЕДИМАЯ ЭКОСИСТЕМА 💎
```

---

## 🎉 РЕЗЮМЕ

### Твое дополнение "QR-код со скидкой" — это **НЕДОСТАЮЩИЙ ЭЛЕМЕНТ**, который:

1. ✅ **Замыкает цикл** (Открыл → Пришел → Получил → Venue видит)
2. ✅ **Доказывает ROI** (Прямая атрибуция)
3. ✅ **Мотивирует действие** (Скидка = причина прийти)
4. ✅ **Создает привыкание** (Геймификация, credits)
5. ✅ **Запускает вирусность** (Реферальная программа)

**Это превращает Promo.Guide из "красивой идеи" в "МАШИНУ РОСТА"!** 🚀

---

**ЧТО ДАЛЬШЕ?**

Создать прототип QR-системы? 😊
